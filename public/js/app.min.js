function elementById(e){return document.getElementById(e)}const HTML_ESCAPE_MAP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;","{":"&#123;","}":"&#125;","(":"&#40;",")":"&#41;","[":"&#91;","]":"&#93;","\\":"&#92;"};function escapeHtml(e){return String(e).replace(/[&<>"'/`=(){}[\]\\]/g,function(e){return HTML_ESCAPE_MAP[e]})}function encodeForAjax(e){return e==null?null:Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")}function createOption(e,t){const n=document.createElement("option");return n.value=e,n.textContent=t,n}function sendAjaxRequest(e,t,n,s,o="application/x-www-form-urlencoded"){let i=new XMLHttpRequest;switch(i.open(e,t,!0),i.setRequestHeader("X-CSRF-TOKEN",document.querySelector('meta[name="csrf-token"]').content),o!=="multipart/form-data"&&i.setRequestHeader("Content-Type",o),i.setRequestHeader("Accept","application/json"),i.addEventListener("load",s),o){case"application/json":i.send(JSON.stringify(n));break;case"application/x-www-form-urlencoded":i.send(encodeForAjax(n));break;default:i.send(n);break}}function toggleMenu(){elementById("mobile-menu").classList.toggle("open-menu"),elementById("mobile-menu").classList.contains("open-menu")?(document.body.style.overflow="hidden",elementById("menu-mobile-hb").textContent="close"):(document.body.style.overflow="",elementById("menu-mobile-hb").innerHTML="menu")}elementById("menu-mobile-hb")&&elementById("menu-mobile-hb").addEventListener("click",toggleMenu);function displayError(e){document.querySelector("#messages").innerHTML=` 
  <article class="error">
      <i class="material-symbols-outlined" title="Error"> error </i>
      <p>${escapeHtml(e)}</p>
      <div class="message-progress"></div>
      <div class="airplane-icon">✈</div>
  </article>`}function displaySuccess(e){document.querySelector("#messages").innerHTML=` 
  <article class="success">
      <i class="material-symbols-outlined" title="Success"> check_circle </i>
      <p>${escapeHtml(e)}</p>
      <div class="message-progress"></div>
      <div class="airplane-icon">✈</div>
  </article>`}function clearInputErrors(){[].forEach.call(document.querySelectorAll(".input-error-message"),function(e){e.remove()})}function placeInputErrors(e,t){if(!e)return;clearInputErrors();let n=null;for(const[i,a]of Object.entries(e)){const o=t.querySelector('[name="'+i+'"]');n===null&&(n=o);const s=document.createElement("em");s.classList.add("input-error-message"),s.innerText=a[0],o.insertAdjacentElement("afterend",s)}n&&n.focus()}function checkPasswordStrength(e){let t=0;return e.length>=10&&(t+=4),e.length>=16&&(t+=2),e.match(/[a-z]/)&&(t+=1),e.match(/[A-Z]/)&&(t+=1),e.match(/[0-9]/)&&(t+=1),e.match(/[^a-zA-Z0-9]/)&&(t+=1),t>9&&(t=9),t}if(elementById("register-form")){const t=elementById("password"),n=elementById("password-confirm"),e=elementById("password-strength"),s=elementById("password-confirmation"),o=document.querySelector("#register-form button[type=submit]");t.addEventListener("input",function(){let s=checkPasswordStrength(t.value);e.value=s;let n="";switch(s){case 0:case 1:case 2:n="Very Weak",e.style.color="red";break;case 3:case 4:n="Moderate",e.style.color="yellow";break;case 5:case 6:case 7:n="Strong",e.style.color="lightgreen";break;case 9:case 8:n="Very Strong",e.style.color="green";break}elementById("password-strength-description").textContent=n}),n.addEventListener("input",function(){t.value===n.value?s.textContent="Passwords Match":s.textContent="Passwords don't match"})}async function setAsConfirmAction(e){e.classList.add("confirm-action"),e.addEventListener("click",async t=>{(e.classList.contains("confirm-action")||e.classList.contains("wait"))&&(t.preventDefault(),t.stopImmediatePropagation(),await confirmActionHandler(e))})}async function confirmActionHandler(e){const t=document.createElement("div");t.classList.add("message-progress"),e.classList.contains("confirm-action")&&!e.classList.contains("wait")&&(e.innerHTML+="Are you sure?",e.classList.add("wait"),e.parentElement.appendChild(t),await new Promise(e=>setTimeout(e,300)),e.classList.remove("wait"),e.classList.remove("confirm-action"),e._interval=setInterval(()=>{clearConfirmAction(e)},2700));const n=document.querySelectorAll(".confirm-action");n.forEach(t=>{t!==e&&clearConfirmAction(t)})}function clearConfirmAction(e){e.classList.contains("confirm-action")||(e.innerHTML=e.innerHTML.replace("Are you sure?",""),e.classList.add("confirm-action"),e.parentElement.removeChild(e.parentElement.children[1]),e._interval&&(clearInterval(e._interval),e._interval=null))}const actions=document.querySelectorAll(".confirm-action");Promise.all(Array.from(actions).map(e=>setAsConfirmAction(e)));function toggleDark(){document.querySelector("body").classList.toggle("dark"),document.querySelectorAll(".dark-mode-btn").forEach(e=>{e.textContent=e.textContent==="dark_mode"?"light_mode":"dark_mode"})}document.querySelectorAll(".dark-mode-btn").forEach(e=>{e.textContent=localStorage.getItem("theme")==="dark"?"light_mode":"dark_mode",e.addEventListener("click",function(){const e=this.textContent;toggleDark(),localStorage.setItem("theme",e==="dark_mode"?"dark":"light")})});const loginoverlay=elementById("overlay-login"),overlayloginform=elementById("outside-login-overlay");function openLoginOverlay(){loginoverlay.showModal()}document.body.addEventListener("click",function(e){e.target===overlayloginform&&loginoverlay.close()});const searchoverlay=document.getElementById("search-overlay"),outsideOverlay=document.getElementById("outside-overlay");document.querySelectorAll(".search-header-btn").forEach(e=>{e.addEventListener("click",()=>{searchoverlay.showModal()})}),outsideOverlay&&outsideOverlay.addEventListener("click",()=>{searchoverlay.open&&searchoverlay.close()});const notificationinbox=elementById("notification-inbox"),notificationbuttonPC=elementById("notification-inbox-buttonpc"),notificationbuttonMobile=elementById("notification-inbox-buttonmobile");function markNotificationViewed(e,t){sendAjaxRequest("put","/api/notification/view",{type:e,id:t});const n=document.querySelector(`.notification-item[data-id='${t}']`);n.remove()}function createNotificationElement(e){let s="",i="answer";e.voter?(i="vote",s="New vote on your question by "+e.username):e.question_title.length>30?s="New answer on "+e.question_title.substring(0,30)+"... by "+e.username+".":s="New answer on "+e.question_title+" by "+e.username+".";const t=document.createElement("div");t.setAttribute("data-id",e.id),t.classList.add("notification-item");const a=document.createElement("p");a.textContent=s;const r=document.createElement("span");r.textContent=`${new Date(e.date).toLocaleString()}`;const n=document.createElement("button");n.classList.add("button-icon"),n.classList.add("normal-text"),n.textContent=`Mark as viewed `,n.style.cursor="pointer",n.onclick=function(){markNotificationViewed(i,e.id)};const o=document.createElement("a");return o.href="/questions/"+e.post_id,o.textContent=" View",t.appendChild(r),t.appendChild(a),t.appendChild(n),t.appendChild(o),t}async function openNotificationBox(e){if(notificationinbox.classList.contains("display")){notificationinbox.classList.toggle("display");return}e&&toggleMenu(),notificationinbox.classList.toggle("display");let n;try{const e=await fetch("/api/notification");n=await e.json()}catch(e){console.error("Error fetching notifications:",e);return}notificationinbox.innerHTML="";const t=document.createElement("button");if(t.classList.add("material-symbols-outlined"),t.classList.add("button-icon"),t.title="Close Inbox",t.textContent="close",t.style.cursor="pointer",t.onclick=function(){notificationinbox.classList.remove("display"),e?notificationbuttonMobile.classList.remove("clicked"):notificationbuttonPC.classList.remove("clicked")},notificationinbox.appendChild(t),!n||n.length===0){const e=document.createElement("p");e.textContent="No notifications available.",notificationinbox.appendChild(e)}n.forEach(e=>{const t=createNotificationElement(e);notificationinbox.appendChild(t)})}notificationbuttonPC&&(notificationbuttonPC.addEventListener("click",()=>{notificationbuttonPC.classList.toggle("clicked"),openNotificationBox(!1)}),notificationbuttonMobile.addEventListener("click",()=>{notificationbuttonMobile.classList.toggle("clicked"),openNotificationBox(!0)}));const infoDivHTML=document.querySelector("#infohelper-div-content"),infoDiv=document.querySelector("#infohelper-div");document.querySelectorAll(".infohelper").forEach(e=>{e.onmouseover=e.onfocus=function(){infoDiv.classList.add("display"),infoDivHTML.innerHTML=e.getAttribute("data-html")},e.onmouseleave=e.onblur=function(){infoDiv.classList.remove("display")}});function updatePFImageURL(){let e=JSON.parse(this.responseText);if(this.status===200){const t=document.getElementById("profile-photo");t.src=`/profile/${e}`;const n=document.querySelector(".profile_photo");n.src=`/profile/${e}`}else displayError(e.message)}function loadFile(e){const t=new FormData;t.append("photo",e.target.files[0]),sendAjaxRequest("post",`/api/users/${getUserIdFromURL()}/image`,t,updatePFImageURL,"multipart/form-data")}