class MultiSelect{constructor(e,t={}){let n={placeholder:"Select item(s)",max:null,search:!0,selectAll:!0,listAll:!0,closeListOnItemSelect:!1,name:"",width:"",height:"",dropdownWidth:"",dropdownHeight:"",data:[],onChange:function(){},onSelect:function(){},onUnselect:function(){}};this.options=Object.assign(n,t),this.selectElement=typeof e=="string"?document.querySelector(e):e;for(const e in this.selectElement.dataset)this.options[e]!==void 0&&(this.options[e]=this.selectElement.dataset[e]);if(this.name=this.selectElement.getAttribute("name")?this.selectElement.getAttribute("name"):"multi-select-"+Math.floor(Math.random()*1e6),!this.options.data.length){let e=this.selectElement.querySelectorAll("option");for(let t=0;t<e.length;t++)this.options.data.push({value:e[t].value,text:e[t].textContent,selected:e[t].hasAttribute("selected"),html:e[t].getAttribute("data-html")})}this.element=this._template(),this.selectElement.replaceWith(this.element),this._updateSelected(),this._eventHandlers()}_template(){let e="";for(let t=0;t<this.data.length;t++)e+=`
                <div class="multi-select-option${this.selectedValues.includes(this.data[t].value)?" multi-select-selected":""}" data-value="${this.data[t].value}">
                    <button type="button" class="button-icon multi-select-option-radio"></button>
                    <span class="multi-select-option-text">${this.data[t].html?this.data[t].html:this.data[t].text}</span>
                </div>
            `;let t="";(this.options.selectAll===!0||this.options.selectAll==="true")&&(t=`<div class="multi-select-all">
                <button type="button" class="button-icon multi-select-option-radio"></button>
                <span class="multi-select-option-text">Select all</span>
            </div>`);let s=`
            <div class="multi-select ${this.id}"${this.selectElement.id?' id="'+this.selectElement.id+'"':""} style="${this.width?"width:"+this.width+";":""}${this.height?"height:"+this.height+";":""}">
                ${this.selectedValues.map(e=>`<input type="hidden" name="${this.name}[]" value="${e}">`).join("")}
                <button type="button" class="multi-select-header button-icon normal-text" style="${this.width?"width:"+this.width+";":""}${this.height?"height:"+this.height+";":""}">
                    <span class="multi-select-header-max">${this.options.max?this.selectedValues.length+"/"+this.options.max:""}</span>
                    <span class="multi-select-header-placeholder">${this.placeholder}</span>
                </button>
                <div class="multi-select-options" style="${this.options.dropdownWidth?"width:"+this.options.dropdownWidth+";":""}${this.options.dropdownHeight?"height:"+this.options.dropdownHeight+";":""}">
                    ${this.options.search===!0||this.options.search==="true"?'<input type="text" class="multi-select-search" placeholder="Search...">':""}
                    ${t}
                    ${e}
                </div>
            </div>
        `,n=document.createElement("div");return n.innerHTML=s,n}_eventHandlers(){let e=this.element.querySelector(".multi-select-header");if(this.element.querySelectorAll(".multi-select-option").forEach(t=>{t.onclick=()=>{let n=!0;if(t.classList.contains("multi-select-selected"))t.classList.remove("multi-select-selected"),this.element.querySelectorAll(".multi-select-header-option").forEach(e=>e.dataset.value===t.dataset.value?e.remove():""),this.element.querySelector(`input[value="${t.dataset.value}"]`).remove(),this.data.filter(e=>e.value===t.dataset.value)[0].selected=!1,n=!1;else{if(this.options.max&&this.selectedValues.length>=this.options.max)return;if(t.classList.add("multi-select-selected"),this.options.listAll===!0||this.options.listAll==="true")if(this.element.querySelector(".multi-select-header-option")){let e=Array.from(this.element.querySelectorAll(".multi-select-header-option")).pop();e.insertAdjacentHTML("afterend",`<span class="multi-select-header-option" data-value="${t.dataset.value}">${t.querySelector(".multi-select-option-text").innerHTML}</span>`)}else e.insertAdjacentHTML("afterbegin",`<span class="multi-select-header-option" data-value="${t.dataset.value}">${t.querySelector(".multi-select-option-text").innerHTML}</span>`);this.element.querySelector(".multi-select").insertAdjacentHTML("afterbegin",`<input type="hidden" name="${this.name}[]" value="${t.dataset.value}">`),this.data.filter(e=>e.value===t.dataset.value)[0].selected=!0}(this.options.listAll===!1||this.options.listAll==="false")&&(this.element.querySelector(".multi-select-header-option")&&this.element.querySelector(".multi-select-header-option").remove(),e.insertAdjacentHTML("afterbegin",`<span class="multi-select-header-option">${this.selectedValues.length} selected</span>`)),this.element.querySelector(".multi-select-header-option")?this.element.querySelector(".multi-select-header-placeholder")&&this.element.querySelector(".multi-select-header-placeholder").remove():e.insertAdjacentHTML("afterbegin",`<span class="multi-select-header-placeholder">${this.placeholder}</span>`),this.options.max&&(this.element.querySelector(".multi-select-header-max").innerHTML=this.selectedValues.length+"/"+this.options.max),(this.options.search===!0||this.options.search==="true")&&(this.element.querySelector(".multi-select-search").value=""),this.element.querySelectorAll(".multi-select-option").forEach(e=>e.style.display="flex"),(this.options.closeListOnItemSelect===!0||this.options.closeListOnItemSelect==="true")&&e.classList.remove("multi-select-header-active"),this.options.onChange(t.dataset.value,t.querySelector(".multi-select-option-text").innerHTML,t),n?this.options.onSelect(t.dataset.value,t.querySelector(".multi-select-option-text").innerHTML,t):this.options.onUnselect(t.dataset.value,t.querySelector(".multi-select-option-text").innerHTML,t)}}),e.onclick=()=>e.classList.toggle("multi-select-header-active"),this.options.search===!0||this.options.search==="true"){let e=this.element.querySelector(".multi-select-search");e.oninput=()=>{this.element.querySelectorAll(".multi-select-option").forEach(t=>{t.style.display=t.querySelector(".multi-select-option-text").innerHTML.toLowerCase().indexOf(e.value.toLowerCase())>-1?"flex":"none"})}}if(this.options.selectAll===!0||this.options.selectAll==="true"){let e=this.element.querySelector(".multi-select-all");e.onclick=()=>{let t=e.classList.contains("multi-select-selected");this.element.querySelectorAll(".multi-select-option").forEach(e=>{let n=this.data.find(t=>t.value===e.dataset.value);n&&(t&&n.selected||!t&&!n.selected)&&e.click()}),e.classList.toggle("multi-select-selected")}}this.selectElement.id&&document.querySelector('label[for="'+this.selectElement.id+'"]')&&(document.querySelector('label[for="'+this.selectElement.id+'"]').onclick=()=>{e.classList.toggle("multi-select-header-active")}),document.addEventListener("click",t=>{!t.target.closest("."+this.id)&&!t.target.closest('label[for="'+this.selectElement.id+'"]')&&e.classList.remove("multi-select-header-active")})}_updateSelected(){this.options.listAll===!0||this.options.listAll==="true"?this.element.querySelectorAll(".multi-select-option").forEach(e=>{e.classList.contains("multi-select-selected")&&this.element.querySelector(".multi-select-header").insertAdjacentHTML("afterbegin",`<span class="multi-select-header-option" data-value="${e.dataset.value}">${e.querySelector(".multi-select-option-text").innerHTML}</span>`)}):this.selectedValues.length>0&&this.element.querySelector(".multi-select-header").insertAdjacentHTML("afterbegin",`<span class="multi-select-header-option">${this.selectedValues.length} selected</span>`),this.element.querySelector(".multi-select-header-option")&&this.element.querySelector(".multi-select-header-placeholder").remove()}get selectedValues(){return this.data.filter(e=>e.selected).map(e=>e.value)}get selectedItems(){return this.data.filter(e=>e.selected)}set data(e){this.options.data=e}get data(){return this.options.data}set selectElement(e){this.options.selectElement=e}get selectElement(){return this.options.selectElement}set element(e){this.options.element=e}get element(){return this.options.element}set placeholder(e){this.options.placeholder=e}get placeholder(){return this.options.placeholder}set name(e){this.options.name=e}get name(){return this.options.name}set width(e){this.options.width=e}get width(){return this.options.width}set height(e){this.options.height=e}get height(){return this.options.height}}document.querySelectorAll("[data-multi-select]").forEach(e=>new MultiSelect(e))