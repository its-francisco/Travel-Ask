const toolbarOptions=[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{header:[1,2,3,4,5,6,!1]}],["image"],[{color:[]}],["clean"]];function getQuill(e){return new Quill(e,{modules:{toolbar:toolbarOptions,keyboard:{bindings:{tab:{key:9,handler:function(){return!0}}}}},theme:"snow"})}if(document.getElementById("editor")){quill=getQuill("#editor"),document.getElementById("content").style.display="none";const e=quill.getModule("toolbar");e.addHandler("image",imageHandler)}function updateImageURL(e){let t=JSON.parse(this.responseText);if(this.status===200){const n=e.getSelection();e.insertEmbed(n.index,"image",`/posts/${t}`)}else displayError(t.message)}function imageHandler(){const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.click(),e.onchange=()=>{const t=e.files[0];if(t){let e=new FormData;e.append("image",t);const n=this;sendAjaxRequest("post","/api/image",e,function(){updateImageURL.call(this,n.quill)},"multipart/form-data")}}}function getQuestionFields(){const t=elementById("title").value,n=sanitizeHTML(elementById("editor").querySelector(".ql-editor")?elementById("editor").querySelector(".ql-editor").innerHTML:elementById("content").value),s=elementById("country").value,o=elementById("city").value;let e=[];const i=document.querySelectorAll(".multi-select-selected.multi-select-option");return i.forEach(function(t){e.push(t.getAttribute("data-value"))}),{content:n,title:t,country:s,city:o,tags:e}}function sanitizeHTML(e){const o=["strong","em","u","s","ol","ul","h1","h2","h3","h4","h5","h6","div","img","p"],t={img:["src"],"*":["style"]},i=["color"],a=new DOMParser,n=a.parseFromString(e,"text/html");function s(e){if(!o.includes(e.tagName.toLowerCase())){e.remove();return}if(Array.from(e.attributes).forEach(n=>{const s=e.tagName.toLowerCase(),o=t[s]||[],i=t["*"]||[];!o.includes(n.name)&&!i.includes(n.name)&&e.removeAttribute(n.name)}),e.hasAttribute("style")){const t=new RegExp(`^(${i.join("|")})\\s*:\\s*[^;]+;?$`,"i"),n=e.style.cssText.split(";").map(e=>e.trim()).filter(e=>t.test(e)).join("; ");e.setAttribute("style",n)}Array.from(e.children).forEach(e=>s(e))}return Array.from(n.body.children).forEach(e=>s(e)),n.body.innerHTML}